<!DOCTYPE html>
<html>
	<head>
		<script src="config.js" type="text/javascript"></script>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
		<title>Счёт</title>
	</head>
	<body>
		<script type="text/javascript">
			const getData = async () => {
				const link = config.serverLink + additionalUrl;
				let response = await fetch(link);
				if (response.ok) {
					let json = await response.json();
					
					return json;
				} else {
					alert("Ошибка HTTP: " + response.status);
				}
			};
			
			const writeData = async () => {
				const data = await getData();
				const len = data.length;
				var total = 0;
				var nds = 0;
				var totalNds = 0;
				for (var i = 0; i < len; i++) {
					total += parseFloat(data[i]['Цена']);
					document.getElementById('data').innerHTML += `
						<tr>
							<th scope="row">${i+1}</th>
							<td>${data[i]['Артикул']}</td>
							<td>${data[i]['Номенкулатура']}</td>
							<td>${data[i]['Цена']}</td>
						</tr>
					`;
				}
				nds = total / 100 * config.ndsPercent;
				totalNds = total + nds;
				
				document.getElementById('total').innerText += total.toString();
				document.getElementById('nds').innerText += nds.toString();
				document.getElementById('totalNds').innerText += totalNds.toString();
				document.getElementById('info').innerText += `Всего наименований ${len}, на сумму ${totalNds} EUR`;
			};
		</script>
		<div class="container">
			<div class="d-flex flex-row-reverse">
				<img src="./img/logo.png" />
			</div>
			<div class="mt-5">
				<div class="h4">Счет на оплату № ВВ-1007 от 9 февраля 2021 г.</div>
			</div>
			<hr />
			<div class="h6">
				<p class="d-inline fw-normal">Поставщик:</p>
				<p class="d-inline fw-bold">
					117857, г. Москва, Вн.Тер.Г. муниципальный округ чертаново северное, ш.Варшавское, дом 125д корпус 1, ком. 215,216
				</p>
			</div>
			<hr />
			<table class="table border border-dark table-bordered">
				<thead class="thead-dark">
					<tr>
						<th scope="col">№</th>
						<th scope="col">Артикул</th>
						<th scope="col">Номенкулатура</th>
						<th scope="col">Цена</th>
					</tr>
				</thead>
				<tbody id="data">
					<script type="text/javascript">
						writeData();
					</script>
				</tbody>
			</table>
			<div class="d-flex flex-row-reverse fw-bold">
				<p class="m-5 mt-0 mb-0" id="total"></p>
				<p>Итого:</p>
			</div>
			<div class="d-flex flex-row-reverse fw-bold">
				<p class="m-5 mt-0 mb-0" id="nds"></p>
				<p>В т.ч. НДС (20%):</p>
			</div>
			<div class="d-flex flex-row-reverse fw-bold">
				<p class="m-5 mt-0 mb-0" id="totalNds"></p>
				<p>Итого с НДС:</p>
			</div>
			<div class="h6 fw-normal" id="info"></div>
			<hr />
		</div>
	</body>
</html>